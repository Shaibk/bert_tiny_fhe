{"level": 16, "engine_max_level": 16, "shape": [256, 64, 64], "num_samples": 128, "keygen_s": 4.457814931869507, "inference_ms": 164962.078125, "output_level": 8, "nvml_peak_gib": null, "nvml_mean_gib": null, "torch_peak_gib": 0.0, "nvml_available": false}
{"level": 16, "engine_max_level": 16, "shape": [256, 64, 64], "num_samples": 128, "keygen_s": 4.116266965866089, "inference_ms": 164762.71875, "output_level": 8, "nvml_peak_gib": 35.79290771484375, "nvml_mean_gib": 29.13822021484375, "torch_peak_gib": 0.0, "nvml_available": true}
{"level": 12, "engine_max_level": 16, "shape": [256, 64, 64], "num_samples": 128, "keygen_s": 4.122016668319702, "inference_ms": 138998.40625, "output_level": 4, "nvml_peak_gib": 30.54095458984375, "nvml_mean_gib": 25.814535001429118, "torch_peak_gib": 0.0, "nvml_available": true}
{"level": 16, "engine_max_level": 16, "shape": [256, 64, 64], "num_samples": 128, "keygen_s": 4.197393417358398, "mult_key_nbytes": null, "hadamard_key_nbytes": null, "sk_level": 16, "mult_key_level": 16, "hadamard_key_level": 16, "input_ct_total_nbytes": 0, "input_level": 16, "stages": [{"name": "Q = X * Wq", "time_ms": 4341.9873046875, "nvml_before_gib": 21.59173583984375, "nvml_after_gib": 23.73236083984375, "nvml_delta_gib": 2.140625, "nvml_peak_gib": 23.73236083984375, "wq_plain_nbytes": 0, "q_ct_nbytes": 0}, {"name": "K = X * Wk", "time_ms": 4595.951171875, "nvml_before_gib": 23.73236083984375, "nvml_after_gib": 25.87298583984375, "nvml_delta_gib": 2.140625, "nvml_peak_gib": 25.87298583984375, "wk_plain_nbytes": 0, "k_ct_nbytes": 0}, {"name": "Score = Q * K", "time_ms": 27727.390625, "nvml_before_gib": 24.74017333984375, "nvml_after_gib": 26.81829833984375, "nvml_delta_gib": 2.078125, "nvml_peak_gib": 26.81829833984375, "score_ct_nbytes": 0}, {"name": "Probs = square(Score)", "time_ms": 6104.96533203125, "nvml_before_gib": 22.53704833984375, "nvml_after_gib": 24.45892333984375, "nvml_delta_gib": 1.921875, "nvml_peak_gib": 24.45892333984375, "probs_ct_nbytes": 0}, {"name": "V = X * Wv", "time_ms": 4594.88623046875, "nvml_before_gib": 23.57611083984375, "nvml_after_gib": 25.71673583984375, "nvml_delta_gib": 2.140625, "nvml_peak_gib": 25.71673583984375, "wv_plain_nbytes": 0, "v_ct_nbytes": 0}, {"name": "Context = Probs * V", "time_ms": 26575.705078125, "nvml_before_gib": 24.58392333984375, "nvml_after_gib": 26.34954833984375, "nvml_delta_gib": 1.765625, "nvml_peak_gib": 26.34954833984375, "context_ct_nbytes": 0}, {"name": "O = Context * Wo", "time_ms": 4365.19482421875, "nvml_before_gib": 23.45111083984375, "nvml_after_gib": 25.09173583984375, "nvml_delta_gib": 1.640625, "nvml_peak_gib": 25.09173583984375, "wo_plain_nbytes": 0, "o_ct_nbytes": 0}, {"name": "AttnOut = X + O", "time_ms": 122.55657958984375, "nvml_before_gib": 23.95892333984375, "nvml_after_gib": 25.59954833984375, "nvml_delta_gib": 1.640625, "nvml_peak_gib": 25.59954833984375, "attn_out_ct_nbytes": 0}, {"name": "FF1 = AttnOut * W1", "time_ms": 17715.923828125, "nvml_before_gib": 28.49017333984375, "nvml_after_gib": 34.55267333984375, "nvml_delta_gib": 6.0625, "nvml_peak_gib": 34.55267333984375, "wff1_plain_nbytes": 0, "ff1_ct_nbytes": 0}, {"name": "GELU = square(FF1)", "time_ms": 22274.740234375, "nvml_before_gib": 30.02142333984375, "nvml_after_gib": 35.58392333984375, "nvml_delta_gib": 5.5625, "nvml_peak_gib": 35.58392333984375, "ff_gelu_ct_nbytes": 0}, {"name": "FF2 = GELU * W2", "time_ms": 18103.642578125, "nvml_before_gib": 34.05267333984375, "nvml_after_gib": 35.31829833984375, "nvml_delta_gib": 1.265625, "nvml_peak_gib": 35.31829833984375, "wff2_plain_nbytes": 0, "ff2_ct_nbytes": 0}, {"name": "Final = AttnOut + FF2", "time_ms": 117.78559875488281, "nvml_before_gib": 25.22454833984375, "nvml_after_gib": 26.49017333984375, "nvml_delta_gib": 1.265625, "nvml_peak_gib": 26.49017333984375, "final_ct_nbytes": 0, "final_level": 8}], "final_level": 8, "final_ct_nbytes": 0}
{"level": 16, "engine_max_level": 16, "shape": [256, 64, 64], "num_samples": 128, "final_level": 8, "overall_peak_gib": 34.18548583984375, "steps": [{"name": "Create GLEngine", "time_ms": 43.26581954956055, "nvml_before_gib": 0.86517333984375, "nvml_after_gib": 0.89642333984375, "nvml_delta_gib": 0.03125, "nvml_peak_gib": 0.89642333984375}, {"name": "KeyGen: create_secret_key", "time_ms": 389.4336223602295, "nvml_before_gib": 0.89642333984375, "nvml_after_gib": 1.21282958984375, "nvml_delta_gib": 0.31640625, "nvml_peak_gib": 0.89642333984375}, {"name": "KeyGen: create_matrix_multiplication_key", "time_ms": 3644.2787647247314, "nvml_before_gib": 1.21282958984375, "nvml_after_gib": 12.53314208984375, "nvml_delta_gib": 11.3203125, "nvml_peak_gib": 1.21282958984375}, {"name": "KeyGen: create_hadamard_multiplication_key", "time_ms": 261.244535446167, "nvml_before_gib": 12.53314208984375, "nvml_after_gib": 18.19329833984375, "nvml_delta_gib": 5.66015625, "nvml_peak_gib": 12.53314208984375}, {"name": "Build FHEBertTinyEncoder", "time_ms": 7.003307342529297, "nvml_before_gib": 18.19329833984375, "nvml_after_gib": 18.19329833984375, "nvml_delta_gib": 0.0, "nvml_peak_gib": 18.19329833984375}, {"name": "Encrypt Inputs (level=16)", "time_ms": 4267.473936080933, "nvml_before_gib": 18.19329833984375, "nvml_after_gib": 20.45892333984375, "nvml_delta_gib": 2.265625, "nvml_peak_gib": 20.74212646484375}, {"name": "Stage Q = X*Wq", "time_ms": 6736.083984375, "nvml_before_gib": 20.45892333984375, "nvml_after_gib": 22.59954833984375, "nvml_delta_gib": 2.140625, "nvml_peak_gib": 24.26751708984375}, {"name": "Stage K = X*Wk", "time_ms": 6619.41748046875, "nvml_before_gib": 22.59954833984375, "nvml_after_gib": 24.74017333984375, "nvml_delta_gib": 2.140625, "nvml_peak_gib": 26.40814208984375}, {"name": "Stage Score = Q*K", "time_ms": 28625.31640625, "nvml_before_gib": 24.74017333984375, "nvml_after_gib": 26.81829833984375, "nvml_delta_gib": 2.078125, "nvml_peak_gib": 27.32220458984375}, {"name": "Stage Probs = square(Score)", "time_ms": 5543.8447265625, "nvml_before_gib": 22.53704833984375, "nvml_after_gib": 24.45892333984375, "nvml_delta_gib": 1.921875, "nvml_peak_gib": 24.45892333984375}, {"name": "Stage V = X*Wv", "time_ms": 6623.50146484375, "nvml_before_gib": 22.44329833984375, "nvml_after_gib": 24.58392333984375, "nvml_delta_gib": 2.140625, "nvml_peak_gib": 25.71673583984375}, {"name": "Stage Context = Probs*V", "time_ms": 27245.939453125, "nvml_before_gib": 24.58392333984375, "nvml_after_gib": 26.34954833984375, "nvml_delta_gib": 1.765625, "nvml_peak_gib": 27.23236083984375}, {"name": "Stage O = Context*Wo", "time_ms": 6718.89892578125, "nvml_before_gib": 22.31829833984375, "nvml_after_gib": 23.95892333984375, "nvml_delta_gib": 1.640625, "nvml_peak_gib": 25.50189208984375}, {"name": "Stage AttnOut = X+O", "time_ms": 121.79341125488281, "nvml_before_gib": 22.19329833984375, "nvml_after_gib": 23.83392333984375, "nvml_delta_gib": 1.640625, "nvml_peak_gib": 23.42376708984375}, {"name": "Stage FF1 = AttnOut*W1", "time_ms": 27352.693359375, "nvml_before_gib": 22.19329833984375, "nvml_after_gib": 28.25579833984375, "nvml_delta_gib": 6.0625, "nvml_peak_gib": 33.16595458984375}, {"name": "Stage GELU = square(FF1)", "time_ms": 22268.873046875, "nvml_before_gib": 28.25579833984375, "nvml_after_gib": 33.81829833984375, "nvml_delta_gib": 5.5625, "nvml_peak_gib": 33.47064208984375}, {"name": "Stage FF2 = GELU*W2", "time_ms": 26968.59375, "nvml_before_gib": 27.75579833984375, "nvml_after_gib": 29.02142333984375, "nvml_delta_gib": 1.265625, "nvml_peak_gib": 34.18548583984375}, {"name": "Stage Final = AttnOut+FF2", "time_ms": 117.93392181396484, "nvml_before_gib": 23.45892333984375, "nvml_after_gib": 24.72454833984375, "nvml_delta_gib": 1.265625, "nvml_peak_gib": 24.72454833984375}]}
{"level": 12, "engine_max_level": 16, "shape": [256, 64, 64], "num_samples": 128, "final_level": 4, "overall_peak_gib": 29.46673583984375, "steps": [{"name": "Create GLEngine", "time_ms": 43.70594024658203, "nvml_before_gib": 0.86517333984375, "nvml_after_gib": 0.89642333984375, "nvml_delta_gib": 0.03125, "nvml_peak_gib": 0.89642333984375}, {"name": "KeyGen: create_secret_key", "time_ms": 3.795146942138672, "nvml_before_gib": 0.89642333984375, "nvml_after_gib": 1.21282958984375, "nvml_delta_gib": 0.31640625, "nvml_peak_gib": 1.21282958984375}, {"name": "KeyGen: create_matrix_multiplication_key", "time_ms": 3648.094892501831, "nvml_before_gib": 1.21282958984375, "nvml_after_gib": 12.53314208984375, "nvml_delta_gib": 11.3203125, "nvml_peak_gib": 1.21282958984375}, {"name": "KeyGen: create_hadamard_multiplication_key", "time_ms": 616.0216331481934, "nvml_before_gib": 12.53314208984375, "nvml_after_gib": 18.19329833984375, "nvml_delta_gib": 5.66015625, "nvml_peak_gib": 18.19329833984375}, {"name": "Build FHEBertTinyEncoder", "time_ms": 7.198810577392578, "nvml_before_gib": 18.19329833984375, "nvml_after_gib": 18.19329833984375, "nvml_delta_gib": 0.0, "nvml_peak_gib": 18.19329833984375}, {"name": "Encrypt Inputs (level=12)", "time_ms": 3072.176456451416, "nvml_before_gib": 18.19329833984375, "nvml_after_gib": 19.95892333984375, "nvml_delta_gib": 1.765625, "nvml_peak_gib": 20.17962646484375}, {"name": "Stage Q = X*Wq", "time_ms": 5942.39501953125, "nvml_before_gib": 19.95892333984375, "nvml_after_gib": 21.59954833984375, "nvml_delta_gib": 1.640625, "nvml_peak_gib": 22.89251708984375}, {"name": "Stage K = X*Wk", "time_ms": 6224.2333984375, "nvml_before_gib": 21.59954833984375, "nvml_after_gib": 23.24017333984375, "nvml_delta_gib": 1.640625, "nvml_peak_gib": 24.53314208984375}, {"name": "Stage Score = Q*K", "time_ms": 23449.2890625, "nvml_before_gib": 23.24017333984375, "nvml_after_gib": 24.81829833984375, "nvml_delta_gib": 1.578125, "nvml_peak_gib": 25.19720458984375}, {"name": "Stage Probs = square(Score)", "time_ms": 5187.23876953125, "nvml_before_gib": 21.53704833984375, "nvml_after_gib": 22.95892333984375, "nvml_delta_gib": 1.421875, "nvml_peak_gib": 22.95892333984375}, {"name": "Stage V = X*Wv", "time_ms": 6354.6171875, "nvml_before_gib": 21.44329833984375, "nvml_after_gib": 23.08392333984375, "nvml_delta_gib": 1.640625, "nvml_peak_gib": 24.37689208984375}, {"name": "Stage Context = Probs*V", "time_ms": 22347.728515625, "nvml_before_gib": 23.08392333984375, "nvml_after_gib": 24.34954833984375, "nvml_delta_gib": 1.265625, "nvml_peak_gib": 24.98236083984375}, {"name": "Stage O = Context*Wo", "time_ms": 6325.63720703125, "nvml_before_gib": 21.31829833984375, "nvml_after_gib": 22.45892333984375, "nvml_delta_gib": 1.140625, "nvml_peak_gib": 23.91204833984375}, {"name": "Stage AttnOut = X+O", "time_ms": 663.7076416015625, "nvml_before_gib": 21.19329833984375, "nvml_after_gib": 22.33392333984375, "nvml_delta_gib": 1.140625, "nvml_peak_gib": 22.33392333984375}, {"name": "Stage FF1 = AttnOut*W1", "time_ms": 24214.328125, "nvml_before_gib": 21.19329833984375, "nvml_after_gib": 25.25579833984375, "nvml_delta_gib": 4.0625, "nvml_peak_gib": 29.04095458984375}, {"name": "Stage GELU = square(FF1)", "time_ms": 14812.7353515625, "nvml_before_gib": 25.25579833984375, "nvml_after_gib": 28.84954833984375, "nvml_delta_gib": 3.59375, "nvml_peak_gib": 28.84954833984375}, {"name": "Stage FF2 = GELU*W2", "time_ms": 24177.703125, "nvml_before_gib": 24.78704833984375, "nvml_after_gib": 25.55267333984375, "nvml_delta_gib": 0.765625, "nvml_peak_gib": 29.46673583984375}, {"name": "Stage Final = AttnOut+FF2", "time_ms": 113.82685089111328, "nvml_before_gib": 21.99017333984375, "nvml_after_gib": 22.75579833984375, "nvml_delta_gib": 0.765625, "nvml_peak_gib": 22.56439208984375}]}
{"level": 16, "engine_max_level": 16, "shape": [256, 64, 64], "num_samples": 128, "total_layer_time_ms": 163035.765625, "nvml_peak_gib": 35.45111083984375, "nvml_mean_gib": 28.398588761039402, "final_level": 8, "stage_recs": [{"name": "Q = X*Wq (incl. encode)", "time_ms": 6337.7294921875, "before_gib": 21.81829833984375, "after_gib": 23.95892333984375, "delta_gib": 2.140625}, {"name": "K = X*Wk (incl. encode)", "time_ms": 6506.8759765625, "before_gib": 23.95892333984375, "after_gib": 26.09954833984375, "delta_gib": 2.140625}, {"name": "Score = Q*K", "time_ms": 28652.861328125, "before_gib": 26.09954833984375, "after_gib": 28.11517333984375, "delta_gib": 2.015625}, {"name": "Probs = square(Score)", "time_ms": 5814.92041015625, "before_gib": 23.83392333984375, "after_gib": 25.72454833984375, "delta_gib": 1.890625}, {"name": "V = X*Wv (incl. encode)", "time_ms": 6309.7080078125, "before_gib": 23.70892333984375, "after_gib": 25.84954833984375, "delta_gib": 2.140625}, {"name": "Context = Probs*V", "time_ms": 27943.365234375, "before_gib": 25.84954833984375, "after_gib": 27.61517333984375, "delta_gib": 1.765625}, {"name": "O = Context*Wo (incl. encode)", "time_ms": 6448.0048828125, "before_gib": 23.58392333984375, "after_gib": 25.22454833984375, "delta_gib": 1.640625}, {"name": "AttnOut = X+O", "time_ms": 122.42022705078125, "before_gib": 23.45892333984375, "after_gib": 25.09954833984375, "delta_gib": 1.640625}, {"name": "FF1 = AttnOut*W1 (incl. encode)", "time_ms": 25430.349609375, "before_gib": 23.45892333984375, "after_gib": 29.52142333984375, "delta_gib": 6.0625}, {"name": "GELU = square(FF1)", "time_ms": 21803.8984375, "before_gib": 29.52142333984375, "after_gib": 35.08392333984375, "delta_gib": 5.5625}, {"name": "FF2 = GELU*W2 (incl. encode)", "time_ms": 26019.443359375, "before_gib": 29.02142333984375, "after_gib": 30.28704833984375, "delta_gib": 1.265625}, {"name": "Final = AttnOut+FF2", "time_ms": 117.86137390136719, "before_gib": 24.72454833984375, "after_gib": 25.99017333984375, "delta_gib": 1.265625}]}
{"level": 16, "engine_max_level": 16, "shape": [256, 64, 64], "num_samples": 128, "total_stage_time_ms": 163257.14190673828, "nvml_peak_gib": 34.18548583984375, "nvml_mean_gib": 27.846554615458505, "final_level": 8, "stage_recs": [{"name": "Q = X*Wq", "encode_ms": 2074.6376953125, "compute_ms": 4564.15869140625, "total_ms": 6638.79638671875, "before_gib": 20.45892333984375, "after_gib": 23.73236083984375, "delta_gib": 3.2734375}, {"name": "K = X*Wk", "encode_ms": 1883.1007080078125, "compute_ms": 4532.7421875, "total_ms": 6415.8428955078125, "before_gib": 22.59954833984375, "after_gib": 25.87298583984375, "delta_gib": 3.2734375}, {"name": "Score = Q*K", "encode_ms": 0.0, "compute_ms": 28433.439453125, "total_ms": 28433.439453125, "before_gib": 24.74017333984375, "after_gib": 26.81829833984375, "delta_gib": 2.078125}, {"name": "Probs = square(Score)", "encode_ms": 0.0, "compute_ms": 6152.302734375, "total_ms": 6152.302734375, "before_gib": 22.53704833984375, "after_gib": 24.45892333984375, "delta_gib": 1.921875}, {"name": "V = X*Wv", "encode_ms": 2001.1427001953125, "compute_ms": 4519.44775390625, "total_ms": 6520.5904541015625, "before_gib": 22.44329833984375, "after_gib": 25.71673583984375, "delta_gib": 3.2734375}, {"name": "Context = Probs*V", "encode_ms": 0.0, "compute_ms": 27711.39453125, "total_ms": 27711.39453125, "before_gib": 24.58392333984375, "after_gib": 26.34954833984375, "delta_gib": 1.765625}, {"name": "O = Context*Wo", "encode_ms": 2180.574462890625, "compute_ms": 4546.1640625, "total_ms": 6726.738525390625, "before_gib": 22.31829833984375, "after_gib": 25.09173583984375, "delta_gib": 2.7734375}, {"name": "AttnOut = X+O", "encode_ms": 0.0, "compute_ms": 122.30655670166016, "total_ms": 122.30655670166016, "before_gib": 22.19329833984375, "after_gib": 23.83392333984375, "delta_gib": 1.640625}, {"name": "FF1 = AttnOut*W1", "encode_ms": 7977.85791015625, "compute_ms": 17926.341796875, "total_ms": 25904.19970703125, "before_gib": 22.19329833984375, "after_gib": 32.78704833984375, "delta_gib": 10.59375}, {"name": "GELU = square(FF1)", "encode_ms": 0.0, "compute_ms": 22464.37109375, "total_ms": 22464.37109375, "before_gib": 28.25579833984375, "after_gib": 33.81829833984375, "delta_gib": 5.5625}, {"name": "FF2 = GELU*W2", "encode_ms": 8594.7333984375, "compute_ms": 17454.599609375, "total_ms": 26049.3330078125, "before_gib": 27.75579833984375, "after_gib": 33.55267333984375, "delta_gib": 5.796875}, {"name": "Final = AttnOut+FF2", "encode_ms": 0.0, "compute_ms": 117.8265609741211, "total_ms": 117.8265609741211, "before_gib": 23.45892333984375, "after_gib": 24.72454833984375, "delta_gib": 1.265625}]}
{"level": 12, "engine_max_level": 16, "shape": [256, 64, 64], "num_samples": 128, "total_stage_time_ms": 139913.7868118286, "nvml_peak_gib": 29.46673583984375, "nvml_mean_gib": 24.950812905521715, "final_level": 4, "stage_recs": [{"name": "Q = X*Wq", "encode_ms": 1860.326171875, "compute_ms": 4379.14794921875, "total_ms": 6239.47412109375, "before_gib": 19.95892333984375, "after_gib": 22.48236083984375, "delta_gib": 2.5234375}, {"name": "K = X*Wk", "encode_ms": 1955.1402587890625, "compute_ms": 4839.04443359375, "total_ms": 6794.1846923828125, "before_gib": 21.59954833984375, "after_gib": 24.12298583984375, "delta_gib": 2.5234375}, {"name": "Score = Q*K", "encode_ms": 0.0, "compute_ms": 23402.806640625, "total_ms": 23402.806640625, "before_gib": 23.24017333984375, "after_gib": 24.81829833984375, "delta_gib": 1.578125}, {"name": "Probs = square(Score)", "encode_ms": 0.0, "compute_ms": 5465.357421875, "total_ms": 5465.357421875, "before_gib": 21.53704833984375, "after_gib": 22.95892333984375, "delta_gib": 1.421875}, {"name": "V = X*Wv", "encode_ms": 1880.8370361328125, "compute_ms": 4552.8125, "total_ms": 6433.6495361328125, "before_gib": 21.44329833984375, "after_gib": 23.96673583984375, "delta_gib": 2.5234375}, {"name": "Context = Probs*V", "encode_ms": 0.0, "compute_ms": 22345.54296875, "total_ms": 22345.54296875, "before_gib": 23.08392333984375, "after_gib": 24.34954833984375, "delta_gib": 1.265625}, {"name": "O = Context*Wo", "encode_ms": 1916.3553466796875, "compute_ms": 4344.6494140625, "total_ms": 6261.0047607421875, "before_gib": 21.31829833984375, "after_gib": 23.34173583984375, "delta_gib": 2.0234375}, {"name": "AttnOut = X+O", "encode_ms": 0.0, "compute_ms": 117.91680145263672, "total_ms": 117.91680145263672, "before_gib": 21.19329833984375, "after_gib": 22.33392333984375, "delta_gib": 1.140625}, {"name": "FF1 = AttnOut*W1", "encode_ms": 7291.49169921875, "compute_ms": 16756.029296875, "total_ms": 24047.52099609375, "before_gib": 21.19329833984375, "after_gib": 28.78704833984375, "delta_gib": 7.59375}, {"name": "GELU = square(FF1)", "encode_ms": 0.0, "compute_ms": 14834.7158203125, "total_ms": 14834.7158203125, "before_gib": 25.25579833984375, "after_gib": 28.84954833984375, "delta_gib": 3.59375}, {"name": "FF2 = GELU*W2", "encode_ms": 7633.87548828125, "compute_ms": 16223.6259765625, "total_ms": 23857.50146484375, "before_gib": 24.78704833984375, "after_gib": 29.08392333984375, "delta_gib": 4.296875}, {"name": "Final = AttnOut+FF2", "encode_ms": 0.0, "compute_ms": 114.11158752441406, "total_ms": 114.11158752441406, "before_gib": 21.99017333984375, "after_gib": 22.75579833984375, "delta_gib": 0.765625}]}
{"level": 8, "engine_max_level": 16, "shape": [256, 64, 64], "num_samples": 128, "total_stage_time_ms": 122778.00676727295, "nvml_peak_gib": 24.78704833984375, "nvml_mean_gib": 22.50464649689503, "final_level": 0, "stage_recs": [{"name": "Q = X*Wq", "encode_ms": 1746.6219482421875, "compute_ms": 4162.92578125, "total_ms": 5909.5477294921875, "before_gib": 19.45892333984375, "after_gib": 21.23236083984375, "delta_gib": 1.7734375}, {"name": "K = X*Wk", "encode_ms": 1786.359375, "compute_ms": 3705.67626953125, "total_ms": 5492.03564453125, "before_gib": 20.59954833984375, "after_gib": 22.37298583984375, "delta_gib": 1.7734375}, {"name": "Score = Q*K", "encode_ms": 0.0, "compute_ms": 20277.84765625, "total_ms": 20277.84765625, "before_gib": 21.74017333984375, "after_gib": 22.81829833984375, "delta_gib": 1.078125}, {"name": "Probs = square(Score)", "encode_ms": 0.0, "compute_ms": 3657.94091796875, "total_ms": 3657.94091796875, "before_gib": 20.53704833984375, "after_gib": 21.45892333984375, "delta_gib": 0.921875}, {"name": "V = X*Wv", "encode_ms": 1852.3123779296875, "compute_ms": 3843.505615234375, "total_ms": 5695.8179931640625, "before_gib": 20.44329833984375, "after_gib": 22.21673583984375, "delta_gib": 1.7734375}, {"name": "Context = Probs*V", "encode_ms": 0.0, "compute_ms": 18130.26953125, "total_ms": 18130.26953125, "before_gib": 21.58392333984375, "after_gib": 22.34954833984375, "delta_gib": 0.765625}, {"name": "O = Context*Wo", "encode_ms": 1822.88720703125, "compute_ms": 3909.49169921875, "total_ms": 5732.37890625, "before_gib": 20.31829833984375, "after_gib": 21.59173583984375, "delta_gib": 1.2734375}, {"name": "AttnOut = X+O", "encode_ms": 0.0, "compute_ms": 114.11974334716797, "total_ms": 114.11974334716797, "before_gib": 20.19329833984375, "after_gib": 20.83392333984375, "delta_gib": 0.640625}, {"name": "FF1 = AttnOut*W1", "encode_ms": 7267.82568359375, "compute_ms": 16201.9951171875, "total_ms": 23469.82080078125, "before_gib": 20.19329833984375, "after_gib": 24.78704833984375, "delta_gib": 4.59375}, {"name": "GELU = square(FF1)", "encode_ms": 0.0, "compute_ms": 11325.07421875, "total_ms": 11325.07421875, "before_gib": 22.25579833984375, "after_gib": 23.81829833984375, "delta_gib": 1.5625}, {"name": "FF2 = GELU*W2", "encode_ms": 7116.6630859375, "compute_ms": 15747.181640625, "total_ms": 22863.8447265625, "before_gib": 21.75579833984375, "after_gib": 24.55267333984375, "delta_gib": 2.796875}, {"name": "Final = AttnOut+FF2", "encode_ms": 0.0, "compute_ms": 109.30889892578125, "total_ms": 109.30889892578125, "before_gib": 20.45892333984375, "after_gib": 20.72454833984375, "delta_gib": 0.265625}]}
{"level": 8, "engine_max_level": 16, "shape": [256, 64, 64], "num_samples": 128, "total_stage_time_ms": 121358.09870910645, "nvml_peak_gib": 24.78704833984375, "nvml_mean_gib": 22.50989990234375, "final_level": 0, "stage_recs": [{"name": "Q = X*Wq", "encode_ms": 1947.3929443359375, "compute_ms": 4451.697265625, "total_ms": 6399.0902099609375, "before_gib": 19.45892333984375, "after_gib": 21.23236083984375, "delta_gib": 1.7734375}, {"name": "K = X*Wk", "encode_ms": 1820.679931640625, "compute_ms": 3885.9873046875, "total_ms": 5706.667236328125, "before_gib": 20.59954833984375, "after_gib": 22.37298583984375, "delta_gib": 1.7734375}, {"name": "Score = Q*K", "encode_ms": 0.0, "compute_ms": 19976.220703125, "total_ms": 19976.220703125, "before_gib": 21.74017333984375, "after_gib": 22.81829833984375, "delta_gib": 1.078125}, {"name": "Probs = square(Score)", "encode_ms": 0.0, "compute_ms": 3702.316162109375, "total_ms": 3702.316162109375, "before_gib": 20.53704833984375, "after_gib": 21.45892333984375, "delta_gib": 0.921875}, {"name": "V = X*Wv", "encode_ms": 1742.813720703125, "compute_ms": 3511.951171875, "total_ms": 5254.764892578125, "before_gib": 20.44329833984375, "after_gib": 22.21673583984375, "delta_gib": 1.7734375}, {"name": "Context = Probs*V", "encode_ms": 0.0, "compute_ms": 17770.74609375, "total_ms": 17770.74609375, "before_gib": 21.58392333984375, "after_gib": 22.34954833984375, "delta_gib": 0.765625}, {"name": "O = Context*Wo", "encode_ms": 1847.9197998046875, "compute_ms": 3752.114990234375, "total_ms": 5600.0347900390625, "before_gib": 20.31829833984375, "after_gib": 21.59173583984375, "delta_gib": 1.2734375}, {"name": "AttnOut = X+O", "encode_ms": 0.0, "compute_ms": 114.13504028320312, "total_ms": 114.13504028320312, "before_gib": 20.19329833984375, "after_gib": 20.83392333984375, "delta_gib": 0.640625}, {"name": "FF1 = AttnOut*W1", "encode_ms": 7097.45166015625, "compute_ms": 15509.6689453125, "total_ms": 22607.12060546875, "before_gib": 20.19329833984375, "after_gib": 24.78704833984375, "delta_gib": 4.59375}, {"name": "GELU = square(FF1)", "encode_ms": 0.0, "compute_ms": 11415.421875, "total_ms": 11415.421875, "before_gib": 22.25579833984375, "after_gib": 23.81829833984375, "delta_gib": 1.5625}, {"name": "FF2 = GELU*W2", "encode_ms": 7277.63623046875, "compute_ms": 15424.568359375, "total_ms": 22702.20458984375, "before_gib": 21.75579833984375, "after_gib": 24.55267333984375, "delta_gib": 2.796875}, {"name": "Final = AttnOut+FF2", "encode_ms": 0.0, "compute_ms": 109.37651062011719, "total_ms": 109.37651062011719, "before_gib": 20.45892333984375, "after_gib": 20.72454833984375, "delta_gib": 0.265625}]}
{"level": 16, "engine_max_level": 16, "shape": [256, 64, 64], "num_samples": 128, "total_stage_time_ms": 164577.49365234375, "nvml_peak_gib": 34.18548583984375, "nvml_mean_gib": 27.73843005471978, "final_level": 8, "stage_recs": [{"name": "Q = X*Wq", "encode_ms": 2115.607666015625, "compute_ms": 4410.392578125, "total_ms": 6526.000244140625, "before_gib": 20.45892333984375, "after_gib": 23.73236083984375, "delta_gib": 3.2734375}, {"name": "K = X*Wk", "encode_ms": 1884.435791015625, "compute_ms": 4725.64990234375, "total_ms": 6610.085693359375, "before_gib": 22.59954833984375, "after_gib": 25.87298583984375, "delta_gib": 3.2734375}, {"name": "Score = Q*K", "encode_ms": 0.0, "compute_ms": 28271.984375, "total_ms": 28271.984375, "before_gib": 24.74017333984375, "after_gib": 26.81829833984375, "delta_gib": 2.078125}, {"name": "Probs = square(Score)", "encode_ms": 0.0, "compute_ms": 5454.9453125, "total_ms": 5454.9453125, "before_gib": 22.53704833984375, "after_gib": 24.45892333984375, "delta_gib": 1.921875}, {"name": "V = X*Wv", "encode_ms": 2240.053466796875, "compute_ms": 4644.88916015625, "total_ms": 6884.942626953125, "before_gib": 22.44329833984375, "after_gib": 25.71673583984375, "delta_gib": 3.2734375}, {"name": "Context = Probs*V", "encode_ms": 0.0, "compute_ms": 27686.51953125, "total_ms": 27686.51953125, "before_gib": 24.58392333984375, "after_gib": 26.34954833984375, "delta_gib": 1.765625}, {"name": "O = Context*Wo", "encode_ms": 2370.99755859375, "compute_ms": 4326.517578125, "total_ms": 6697.51513671875, "before_gib": 22.31829833984375, "after_gib": 25.09173583984375, "delta_gib": 2.7734375}, {"name": "AttnOut = X+O", "encode_ms": 0.0, "compute_ms": 122.37721252441406, "total_ms": 122.37721252441406, "before_gib": 22.19329833984375, "after_gib": 23.83392333984375, "delta_gib": 1.640625}, {"name": "FF1 = AttnOut*W1", "encode_ms": 9279.3515625, "compute_ms": 18307.041015625, "total_ms": 27586.392578125, "before_gib": 22.19329833984375, "after_gib": 32.78704833984375, "delta_gib": 10.59375}, {"name": "GELU = square(FF1)", "encode_ms": 0.0, "compute_ms": 21869.716796875, "total_ms": 21869.716796875, "before_gib": 28.25579833984375, "after_gib": 33.81829833984375, "delta_gib": 5.5625}, {"name": "FF2 = GELU*W2", "encode_ms": 9368.8095703125, "compute_ms": 17380.439453125, "total_ms": 26749.2490234375, "before_gib": 27.75579833984375, "after_gib": 33.55267333984375, "delta_gib": 5.796875}, {"name": "Final = AttnOut+FF2", "encode_ms": 0.0, "compute_ms": 117.76512145996094, "total_ms": 117.76512145996094, "before_gib": 23.45892333984375, "after_gib": 24.72454833984375, "delta_gib": 1.265625}]}
{"level": 8, "engine_max_level": 16, "shape": [256, 64, 64], "num_samples": 128, "total_stage_time_ms": 122508.56911468506, "nvml_peak_gib": 24.91595458984375, "nvml_mean_gib": 22.517090356650474, "final_level": 0, "stage_recs": [{"name": "Q = X*Wq", "encode_ms": 1887.4671630859375, "compute_ms": 3906.255859375, "total_ms": 5793.7230224609375, "before_gib": 19.45892333984375, "after_gib": 21.23236083984375, "delta_gib": 1.7734375}, {"name": "K = X*Wk", "encode_ms": 1895.5235595703125, "compute_ms": 3678.53515625, "total_ms": 5574.0587158203125, "before_gib": 20.59954833984375, "after_gib": 22.37298583984375, "delta_gib": 1.7734375}, {"name": "Score = Q*K", "encode_ms": 0.0, "compute_ms": 19743.064453125, "total_ms": 19743.064453125, "before_gib": 21.74017333984375, "after_gib": 22.81829833984375, "delta_gib": 1.078125}, {"name": "Probs = square(Score)", "encode_ms": 0.0, "compute_ms": 3965.980712890625, "total_ms": 3965.980712890625, "before_gib": 20.53704833984375, "after_gib": 21.45892333984375, "delta_gib": 0.921875}, {"name": "V = X*Wv", "encode_ms": 2042.9683837890625, "compute_ms": 3753.591064453125, "total_ms": 5796.5594482421875, "before_gib": 20.44329833984375, "after_gib": 22.21673583984375, "delta_gib": 1.7734375}, {"name": "Context = Probs*V", "encode_ms": 0.0, "compute_ms": 18342.57421875, "total_ms": 18342.57421875, "before_gib": 21.58392333984375, "after_gib": 22.34954833984375, "delta_gib": 0.765625}, {"name": "O = Context*Wo", "encode_ms": 1921.849853515625, "compute_ms": 3608.229736328125, "total_ms": 5530.07958984375, "before_gib": 20.31829833984375, "after_gib": 21.59173583984375, "delta_gib": 1.2734375}, {"name": "AttnOut = X+O", "encode_ms": 0.0, "compute_ms": 114.21900939941406, "total_ms": 114.21900939941406, "before_gib": 20.19329833984375, "after_gib": 20.83392333984375, "delta_gib": 0.640625}, {"name": "FF1 = AttnOut*W1", "encode_ms": 7606.578125, "compute_ms": 15968.404296875, "total_ms": 23574.982421875, "before_gib": 20.19329833984375, "after_gib": 24.78704833984375, "delta_gib": 4.59375}, {"name": "GELU = square(FF1)", "encode_ms": 0.0, "compute_ms": 11200.212890625, "total_ms": 11200.212890625, "before_gib": 22.25579833984375, "after_gib": 23.81829833984375, "delta_gib": 1.5625}, {"name": "FF2 = GELU*W2", "encode_ms": 7526.68310546875, "compute_ms": 15237.0927734375, "total_ms": 22763.77587890625, "before_gib": 21.75579833984375, "after_gib": 24.55267333984375, "delta_gib": 2.796875}, {"name": "Final = AttnOut+FF2", "encode_ms": 0.0, "compute_ms": 109.33875274658203, "total_ms": 109.33875274658203, "before_gib": 20.45892333984375, "after_gib": 20.72454833984375, "delta_gib": 0.265625}]}
{"level": 8, "engine_max_level": 16, "shape": [256, 64, 64], "num_samples": 128, "total_stage_time_ms": 123923.95637512207, "nvml_peak_gib": 24.78704833984375, "nvml_mean_gib": 22.515820112384734, "final_level": 0, "stage_recs": [{"name": "Q = X*Wq", "encode_ms": 2003.129638671875, "compute_ms": 3609.298828125, "total_ms": 5612.428466796875, "before_gib": 19.45892333984375, "after_gib": 21.23236083984375, "delta_gib": 1.7734375}, {"name": "K = X*Wk", "encode_ms": 1876.948486328125, "compute_ms": 3847.22998046875, "total_ms": 5724.178466796875, "before_gib": 20.59954833984375, "after_gib": 22.37298583984375, "delta_gib": 1.7734375}, {"name": "Score = Q*K", "encode_ms": 0.0, "compute_ms": 20314.732421875, "total_ms": 20314.732421875, "before_gib": 21.74017333984375, "after_gib": 22.81829833984375, "delta_gib": 1.078125}, {"name": "Probs = square(Score)", "encode_ms": 0.0, "compute_ms": 4085.801025390625, "total_ms": 4085.801025390625, "before_gib": 20.53704833984375, "after_gib": 21.45892333984375, "delta_gib": 0.921875}, {"name": "V = X*Wv", "encode_ms": 2012.64404296875, "compute_ms": 3593.137451171875, "total_ms": 5605.781494140625, "before_gib": 20.44329833984375, "after_gib": 22.21673583984375, "delta_gib": 1.7734375}, {"name": "Context = Probs*V", "encode_ms": 0.0, "compute_ms": 18250.384765625, "total_ms": 18250.384765625, "before_gib": 21.58392333984375, "after_gib": 22.34954833984375, "delta_gib": 0.765625}, {"name": "O = Context*Wo", "encode_ms": 2069.0859375, "compute_ms": 3770.39404296875, "total_ms": 5839.47998046875, "before_gib": 20.31829833984375, "after_gib": 21.59173583984375, "delta_gib": 1.2734375}, {"name": "AttnOut = X+O", "encode_ms": 0.0, "compute_ms": 114.23334503173828, "total_ms": 114.23334503173828, "before_gib": 20.19329833984375, "after_gib": 20.83392333984375, "delta_gib": 0.640625}, {"name": "FF1 = AttnOut*W1", "encode_ms": 8120.85595703125, "compute_ms": 15501.7939453125, "total_ms": 23622.64990234375, "before_gib": 20.19329833984375, "after_gib": 24.78704833984375, "delta_gib": 4.59375}, {"name": "GELU = square(FF1)", "encode_ms": 0.0, "compute_ms": 11234.748046875, "total_ms": 11234.748046875, "before_gib": 22.25579833984375, "after_gib": 23.81829833984375, "delta_gib": 1.5625}, {"name": "FF2 = GELU*W2", "encode_ms": 8360.71875, "compute_ms": 15047.275390625, "total_ms": 23407.994140625, "before_gib": 21.75579833984375, "after_gib": 24.55267333984375, "delta_gib": 2.796875}, {"name": "Final = AttnOut+FF2", "encode_ms": 0.0, "compute_ms": 111.54431915283203, "total_ms": 111.54431915283203, "before_gib": 20.45892333984375, "after_gib": 20.72454833984375, "delta_gib": 0.265625}]}
{"level": 8, "engine_max_level": 16, "shape": [256, 64, 64], "num_samples": 128, "ffn_w1_delta": 5, "ffn_w2_delta": 7, "total_stage_time_ms": 108295.9140625, "nvml_peak_gib": 24.43157958984375, "nvml_mean_gib": 22.30238924893466, "final_level": 0, "stage_recs": [{"name": "BertTiny_1Layer", "total_ms": 108295.9140625, "before_gib": 19.45892333984375, "after_gib": 19.81829833984375, "delta_gib": 0.359375}]}
{"level": 16, "engine_max_level": 16, "shape": [256, 64, 64], "num_samples": 128, "ffn_w1_delta": 5, "ffn_w2_delta": 7, "total_stage_time_ms": 144332.421875, "nvml_peak_gib": 34.88861083984375, "nvml_mean_gib": 28.05579833984375, "final_level": 8, "stage_recs": [{"name": "BertTiny_1Layer", "total_ms": 144332.421875, "before_gib": 20.45892333984375, "after_gib": 21.81829833984375, "delta_gib": 1.359375}]}
{"level": 16, "engine_max_level": 16, "shape": [256, 64, 64], "num_samples": 128, "ffn_w1_delta": 5, "ffn_w2_delta": 7, "total_stage_time_ms": 143190.859375, "nvml_peak_gib": 35.23626708984375, "nvml_mean_gib": 28.192129803518963, "final_level": 8, "stage_recs": [{"name": "BertTiny_1Layer", "total_ms": 143190.859375, "before_gib": 20.45892333984375, "after_gib": 21.81829833984375, "delta_gib": 1.359375}]}
{"level": 8, "engine_max_level": 16, "shape": [256, 64, 64], "num_samples": 128, "ffn_w1_delta": 5, "ffn_w2_delta": 7, "total_stage_time_ms": 107154.390625, "nvml_peak_gib": 24.58392333984375, "nvml_mean_gib": 22.287522930965245, "final_level": 0, "stage_recs": [{"name": "BertTiny_1Layer", "total_ms": 107154.390625, "before_gib": 19.45892333984375, "after_gib": 19.81829833984375, "delta_gib": 0.359375}]}
{"level": 8, "engine_max_level": 16, "shape": [256, 64, 64], "num_samples": 128, "ffn_w1_delta": 5, "ffn_w2_delta": 7, "total_stage_time_ms": 107659.171875, "nvml_peak_gib": 24.43157958984375, "nvml_mean_gib": 22.289995783025567, "final_level": 0, "stage_recs": [{"name": "BertTiny_1Layer", "total_ms": 107659.171875, "before_gib": 19.45892333984375, "after_gib": 19.81829833984375, "delta_gib": 0.359375}]}
